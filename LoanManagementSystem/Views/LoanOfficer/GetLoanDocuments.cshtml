@model LoanManagementSystem.Models.LoanApplication

@{
    ViewBag.Title = "Get Loan Documents";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">


<div id="loader" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.7); color: white; text-align: center; padding-top: 20%; z-index: 1000;">
    <img src="~/Content/Loader.gif" />
    <h2>Loading...</h2>
</div>
<div>
    <h2>Get Loan Documents</h2>

    <p>
        <button type="button" id="approveBtn" class="btn btn-success">Approve</button> |
        <button type="button" id="rejectBtn" class="btn btn-danger">Reject</button>
    </p>


    <div class="container ">
        <h2 class="text-center">Uploaded Images</h2>

        @if (Model.RegistrationDocuments.Any())
        {
            <div style="height:90vh; width:500px; margin-left:25%" id="imageCarousel" class="carousel slide" data-ride="carousel">
                <div class="carousel-inner" style="height:90vh; width:500px">
                    @for (var i = 0; i < Model.RegistrationDocuments.Count(); i++)
                    {
                        var image = Model.RegistrationDocuments.ElementAt(i);
                        <div class="carousel-item @(i == 0 ? "active" : "")">
                            <img class="d-block w-100" src="@image.ImageUrl" alt="Image @(i + 1)">
                        </div>
                    }
                </div>

                <!-- Left and right controls -->
                <a class="carousel-control-prev" href="#imageCarousel" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#imageCarousel" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
        }
        else
        {
            <div class="alert alert-info text-center">
                No images found.
            </div>
        }
    </div>


</div>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.1/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>


<script>
        $(document).ready(function () {
            $('#approveBtn').click(function () {
                var comments = $('#comments').val();
                if (comments === "") {
                    alert("Please add comments!")
                    return;
                }
                $("#loader").show()
                $.ajax({
                    url: '@Url.Action("ApproveLoan", "LoanOfficer")',
                    type: 'POST',
                    data: {
                        id: '@Model.ApplicationId',
                        comments: comments
                    },
                    success: function (response) {
                        // Handle success, e.g., show a success message or redirect
                        alert("Loan application approved successfully!");
                        $("#loader").hide()
                        // Optionally, redirect to another page
                         window.location.href = '@Url.Action("Welcome", "LoanOfficer")';
                    },
                    error: function (xhr, status, error) {
                        // Handle error
                        alert("An error occurred while approving the application.");
                    }
                });
            });

            $('#rejectBtn').click(function () {
                var comments = $('#comments').val();
                if (comments === "") {
                    alert("Please add comments!")
                    return;
                }
                $("#loader").show()
                $.ajax({
                    url: '@Url.Action("RejectLoan", "LoanOfficer")',
                    type: 'POST',
                    data: {
                        id: '@Model.ApplicationId',
                        comments: comments
                    },
                    success: function (response) {
                        // Handle success, e.g., show a success message or redirect
                        alert("Loan application rejected successfully!");
                        // Optionally, redirect to another page
                        $("#loader").hide()
                         window.location.href = '@Url.Action("Welcome", "LoanOfficer")';
                    },
                    error: function (xhr, status, error) {
                        // Handle error
                        alert("An error occurred while rejecting the application.");
                    }
                });
            });
        });
</script>






