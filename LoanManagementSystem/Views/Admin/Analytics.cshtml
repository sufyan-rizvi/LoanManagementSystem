@using Newtonsoft.Json
@{
    ViewBag.Title = "Analytics";
    Layout = null;
}



<h2>Loan Management Analytics</h2>

<div style="width:75%;">
    <canvas id="barChart"></canvas>
    <p>
        <strong>Analysis:</strong> The bar chart shows the number of loan applications over the past five months. The data indicates that February saw the highest number of applications, while March had the fewest. This can help assess seasonal trends in loan demand and guide staffing or promotional efforts accordingly.
    </p>
</div>

<div class="row">
    <div class="col">
        <div class="form-group" style="width:90%;">
            <canvas id="pieChart"></canvas>
            <p>
                <strong>Analysis:</strong> The pie chart presents the distribution of loan statuses. A large portion of the loans are currently active, with a smaller share either closed or awaiting approval. This helps in understanding the current workload and potential future demands in loan management.
            </p>
        </div>
    </div>

    <div class="col">
        <div class="form-group" style="width:90%;">
            <canvas id="doughnutChart"></canvas>
            <p>
                <strong>Analysis:</strong> The doughnut chart illustrates the distribution of users by role. Most users are customers, followed by loan officers, with a smaller portion being admins. This insight can help in organizing resources and providing better support for each user group.
            </p>
        </div>
    </div>
</div>

<!-- Line Chart Section -->
<div style="width:75%; margin-top: 30px;">
    <canvas id="lineChart"></canvas>
    <p>
        <strong>Analysis:</strong> The line chart illustrates the total loan amounts approved over the same period. The chart shows an upward trend from March to May, indicating a possible increase in loan size, which could suggest larger or more frequent loans being taken by customers.
    </p>
</div>

<!-- Horizontal Bar Chart for NPA Percentage -->
<div style="width:75%; margin-top: 30px;">
    <canvas id="npaChart"></canvas>
    <p>
        <strong>Analysis:</strong> The horizontal bar chart shows the NPA percentages across months. May has the highest percentage, indicating an increase in non-performing assets. This could point to a need for more stringent loan recovery methods.
    </p>
</div>

<!-- Add more canvas elements for additional charts -->

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>


    // Pie Chart
    var pieChart = document.getElementById('pieChart').getContext('2d');
    var pieChartInstance = new Chart(pieChart, {
        type: 'pie',
        data: {
            labels: ['Active Loans', 'Closed Loans', 'Pending Approval'],
            datasets: [{
                label: 'Loan Status',
                data: [300, 50, 100],
                backgroundColor: [
                    'rgba(255, 99, 132, 0.2)',
                    'rgba(54, 162, 235, 0.2)',
                    'rgba(255, 206, 86, 0.2)'
                ],
                borderColor: [
                    'rgba(255, 99, 132, 1)',
                    'rgba(54, 162, 235, 1)',
                    'rgba(255, 206, 86, 1)'
                ],
                borderWidth: 1
            }]
        }
    });

    // Doughnut Chart
    var doughnutChart = document.getElementById('doughnutChart').getContext('2d');
    var doughnutChartInstance = new Chart(doughnutChart, {
        type: 'doughnut',
        data: {
            labels: ['Loan Officers', 'Customers', 'Admins'],
            datasets: [{
                label: 'User Roles',
                data: [50, 100, 10],
                backgroundColor: [
                    'rgba(153, 102, 255, 0.2)',
                    'rgba(255, 159, 64, 0.2)',
                    'rgba(75, 192, 192, 0.2)'
                ],
                borderColor: [
                    'rgba(153, 102, 255, 1)',
                    'rgba(255, 159, 64, 1)',
                    'rgba(75, 192, 192, 1)'
                ],
                borderWidth: 1
            }]
        }
    });





    //Bar Chart

    var loanApplications = @Html.Raw(JsonConvert.SerializeObject(ViewBag.LoanApplications));

    var barChart = document.getElementById('barChart').getContext('2d');
    var barChartInstance = new Chart(barChart, {
        type: 'bar',
        data: {
            labels: ['January', 'February', 'March', 'April', 'May'],
            datasets: [{
                label: 'Loan Applications',
                data: loanApplications,
                backgroundColor: 'rgba(75, 192, 192, 0.2)',
                borderColor: 'rgba(75, 192, 192, 1)',
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });


    // Line Chart Data
    var loanAmounts = @Html.Raw(JsonConvert.SerializeObject(ViewBag.LoanAmounts));
    var months = @Html.Raw(JsonConvert.SerializeObject(ViewBag.Months));
    // Line Chart for Loan Amounts
    var lineChart = document.getElementById('lineChart').getContext('2d');
    var lineChartInstance = new Chart(lineChart, {
        type: 'line',
        data: {
            labels: months,
            datasets: [{
                label: 'Loan Amounts (in USD)',
                data: loanAmounts,
                backgroundColor: 'rgba(153, 102, 255, 0.2)',
                borderColor: 'rgba(153, 102, 255, 1)',
                borderWidth: 2,
                fill: false
            }]
        },
        options: {
            scales: {
                x: {
                    title: {
                        display: true,
                        text: 'Months'
                    }
                },
                y: {
                    beginAtZero: true,
                    title: {
                        display: true,
                        text: 'Loan Amount (in USD)'
                    }
                }
            }
        }
    });



    var npaPercentages = @Html.Raw(JsonConvert.SerializeObject(ViewBag.NPAPercentages));

    // Horizontal Bar Chart for NPA Percentage
    var npaChart = document.getElementById('npaChart').getContext('2d');
    var npaChartInstance = new Chart(npaChart, {
        type: 'bar',
        data: {
            labels: months,
            datasets: [{
                label: 'NPA Percentage (%)',
                data: npaPercentages,
                backgroundColor: 'rgba(255, 159, 64, 0.2)',
                borderColor: 'rgba(255, 159, 64, 1)',
                borderWidth: 1
            }]
        },
        options: {
            indexAxis: 'y',  // This makes it horizontal
            scales: {
                x: {
                    beginAtZero: true
                }
            }
        }
    });


</script>



